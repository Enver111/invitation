server {
	listen 80;
	server_name _;

	root /usr/share/nginx/html;
	index index.html;

	# Proxy to Telegram API for frontend requests (force IPv4, strip /telegram prefix)
	location /telegram/ {
		resolver 1.1.1.1 8.8.8.8 ipv6=off valid=300s;
		# Trailing slash ensures /telegram/ is replaced with / in upstream path
		proxy_pass https://api.telegram.org/;
		proxy_set_header Host api.telegram.org;
		proxy_ssl_server_name on;
		proxy_connect_timeout 10s;
		proxy_read_timeout 15s;
		proxy_send_timeout 15s;
	}

	# Cache static assets
	location ~* \.(js|css|png|jpg|jpeg|gif|svg|woff2?)$ {
		expires 7d;
		add_header Cache-Control "public, max-age=604800";
		try_files $uri =404;
	}

	# SPA fallback
	location / {
		try_files $uri $uri/ /index.html;
	}
}
